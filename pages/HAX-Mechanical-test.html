<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAX Engineering Aptitude Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Styles adapted from the CAD Test example */
        body {
            font-family: 'Inter', sans-serif;
            /* Use Inter font */
            background-color: #f3f4f6;
            /* bg-gray-100 */
        }

        .page-section {
            display: none;
            /* Hide all pages by default */
            min-height: 80vh;
            /* Ensure pages take significant height */
        }

        .page-section.active {
            display: flex;
            /* Show the active page */
            flex-direction: column;
            justify-content: center;
            /* Center content vertically */
            align-items: center;
            /* Center content horizontally */
        }

        .content-container {
            background-color: #ffffff;
            /* bg-white */
            padding: 2rem;
            /* p-8 */
            border-radius: 0.5rem;
            /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            /* shadow-md */
            width: 100%;
            max-width: 48rem;
            /* max-w-3xl */
            margin: 1rem auto;
            /* Center the box */
            margin-top: 1rem;
        }

        #userDetailsPage .content-container {
            max-width: 32rem;
            /* max-w-md */
        }

        #pager-timer-header {
            position: sticky;
            /* Makes the header stick to the top */
            top: 0;
            /* Sticks to the top of the viewport */
            z-index: 10;
            /* Ensures it stays above other elements */
            background-color: #ffffff;
            /* Matches the background color */
            padding: 1rem;
            /* Adds padding for spacing */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            /* Adds a subtle shadow for separation */
            margin-bottom: 1rem;
        }

        #questionsContainer {
            margin-top: 1rem;
            /* Ensures the quiz content starts below the sticky header */
            padding-top: 1rem;
            /* Adds padding for better spacing */
        }

        .input-field {
            margin-top: 0.25rem;
            /* mt-1 */
            display: block;
            width: 100%;
            padding: 0.5rem 0.75rem;
            /* px-3 py-2 */
            border: 1px solid #d1d5db;
            /* border-gray-300 */
            border-radius: 0.375rem;
            /* rounded-md */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            /* shadow-sm */
            font-size: 0.875rem;
            /* sm:text-sm */
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .input-field:focus {
            outline: none;
            border-color: #4f46e5;
            /* focus:border-indigo-500 */
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.3);
            /* focus:ring-indigo-500 equivalent */
        }

        .error-message {
            color: #dc2626;
            /* red-600 */
            font-size: 0.875rem;
            /* text-sm */
            margin-top: 0.25rem;
            /* mt-1 */
            display: block;
            /* Ensure it takes space */
            text-align: left;
            /* Match CAD test error alignment */
            min-height: 1.25rem;
            /* Ensure space even when empty */
        }

        .error-message.hidden {
            display: none;
        }

        .input-field.border-red-500 {
            border-color: #ef4444;
        }

        .question-container {
            background-color: #f9fafb;
            /* bg-gray-50 */
            border: 1px solid #e5e7eb;
            /* border-gray-200 */
            border-radius: 0.375rem;
            /* rounded-md */
            padding: 1.5rem;
            /* p-6 */
            margin-bottom: 1.5rem;
            /* mb-6 */
        }

        .question-text {
            font-weight: 600;
            /* font-semibold */
            margin-bottom: 1rem;
            /* mb-4 */
            color: #374151;
            /* text-gray-700 */
        }

        /* Style for question images */
        .question-image {
            display: block;
            max-width: 100%;
            /* Ensure image fits container */
            height: auto;
            /* Maintain aspect ratio */
            margin-top: 1rem;
            /* Add space above image */
            margin-bottom: 1rem;
            /* Add space below image */
            border: 1px solid #e5e7eb;
            /* Subtle border */
            border-radius: 0.375rem;
            /* Rounded corners */
        }

        .option-label {
            display: block;
            margin-bottom: 0.75rem;
            /* mb-3 */
            padding: 0.75rem;
            /* p-3 */
            border-radius: 0.375rem;
            /* rounded-md */
            background-color: #ffffff;
            /* bg-white */
            border: 1px solid #d1d5db;
            /* border-gray-300 */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
            font-size: 0.875rem;
            /* text-sm */
            color: #374151;
            /* text-gray-700 */
        }

        .option-label:hover {
            background-color: #f3f4f6;
        }

        input[type="radio"]:checked+.option-label {
            background-color: #e0e7ff;
            /* bg-indigo-100 */
            border-color: #818cf8;
            /* border-indigo-400 */
            color: #3730a3;
            /* text-indigo-800 */
            font-weight: 500;
            /* font-medium */
        }

        input[type="radio"] {
            display: none;
        }

        .action-button {
            display: inline-flex;
            justify-content: center;
            width: 100%;
            /* w-full */
            padding: 0.5rem 1rem;
            /* py-2 px-4 */
            border: 1px solid transparent;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            /* shadow-sm */
            font-size: 0.875rem;
            /* text-sm */
            font-weight: 500;
            /* font-medium */
            border-radius: 0.375rem;
            /* rounded-md */
            color: #ffffff;
            /* text-white */
            background-color: #4f46e5;
            /* bg-indigo-600 */
            cursor: pointer;
            transition: background-color 0.15s ease-in-out;
        }

        .action-button:hover {
            background-color: #4338ca;
        }

        .action-button:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.5), 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        .action-button:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .timer-container {
            font-size: 1.5rem;
            /* text-2xl */
            font-weight: 600;
            /* font-semibold */
            color: #dc2626;
            /* text-red-600 */
            text-align: right;
            /* Align to the right */
        }

        .timer-expired {
            color: #dc2626;
            font-weight: bold;
        }

        .results-container {
            margin-top: 2rem;
            /* mt-8 */
            padding: 2rem;
            /* p-8 */
            background-color: #ffffff;
            /* bg-white */
            border-radius: 0.5rem;
            /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            /* shadow-md */
            text-align: center;
            font-size: 1.125rem;
            /* text-lg */
            font-weight: 500;
            /* font-medium */
            color: #1f2937;
            /* text-gray-800 */
        }

        .diagram-svg {
            /* Kept for potential future use, but not used in current questions */
            display: block;
            margin: 1rem auto;
            max-width: 300px;
            border: 1px solid #ccc;
            background-color: #fff;
            padding: 10px;
            border-radius: 4px;
        }

        .hidden {
            display: none;
        }

        label {
            display: block;
            text-align: left;
            font-size: 0.875rem;
            /* text-sm */
            font-weight: 500;
            /* font-medium */
            color: #374151;
            /* text-gray-700 */
            margin-bottom: 0.25rem;
            /* mb-1 */
        }

        .text-center {
            text-align: center;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="bg-gray-100">

    <div id="userDetailsPage" class="page-section">
        <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md text-center">
            <div id="logo" class="mb-4">
                <img src="./img/logo/LOGO_HAX_GREEN.png" alt="Logo" class="h-12 mx-auto">
            </div>
            <h1 class="text-xl md:text-2xl font-bold text-center text-gray-800 mb-6">Engineering Aptitude
                Test</h1>
            <p class="text-center text-gray-600 text-sm mb-6"> Welcome to Engineering Aptitude Test. This test is designed to test your reasoning, Analytical and problem-solving skills. It consists of 40 multiple-choice questions covering various topics in engineering. <br> <br>
                Please fill in your details below to start the test. You will have<span class="text-red-600 font-bold"> <span
                    id="testDurationDisplay">30</span> minutes</span> to complete the test once you start.
            </p>
            <form id="userDetailsForm" class="space-y-4">
                <div>
                    <label for="userName">Full Name:</label>
                    <input type="text" id="userName" name="userName" required class="input-field"
                        placeholder="Enter your name">
                    <span id="userNameError" class="error-message hidden">Name is required.</span>
                </div>
                <div>
                    <label for="userEmail">Email Address:</label>
                    <input type="email" id="userEmail" name="userEmail" required class="input-field"
                        placeholder="Enter your email">
                    <span id="userEmailError" class="error-message hidden">Please enter a valid email address.</span>
                </div>
                <div>
                    <label for="userPhone">Phone Number:</label>
                    <input type="tel" id="userPhone" name="userPhone" required class="input-field"
                        placeholder="Enter your phone number">
                    <span id="userPhoneError" class="error-message hidden">Phone number is required.</span>
                </div>
                <div class="pt-2">
                    <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out padding-2 mt-4">Start Test</button>
                </div>
            </form>
        </div>
    </div>

    <div id="quizPage" class="page-section hidden">
        <div id="pager-timer-header" class="content-container">

            <div class="flex justify-between items-center mb-4 border-b border-gray-200 pb-4">
                <h1 class="text-xl font-bold text-gray-800">Test In Progress</h1>

                <div id="timer" class="timer-container">30:00</div>
            </div>
            <div class="mb-6 p-4 bg-gray-50 rounded-md border border-gray-200 text-sm text-gray-600">
                <p><strong>Name:</strong> <span id="displayUserName"></span></p>
                <p><strong>Email:</strong> <span id="displayUserEmail"></span></p>
                <p> ________________________________________________<span id="displayUserEmail"></span></p>
                <p><strong>Total No of Questions : 40</strong> <span id="totalQuestions"></span></p>
                <p><strong>Attempted Questions :</strong> <span id="attemptedQuestions"></span></p>
            </div>
        </div>

        <div class="content-container">

            <form id="quizForm">
                <div id="questionsContainer">
                </div>
                <div class="text-center mt-8">
                    <button type="submit" id="submitButton" class="action-button w-auto px-6">Submit Test</button>
                </div>
            </form>
        </div>
    </div>

    <div id="resultsPage" class="page-section hidden">
        <div class="content-container max-w-md">
            <svg class="mx-auto h-12 w-12 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"
                aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h1 class="text-2xl font-bold mt-4 mb-4 text-center text-gray-800">Test Submitted!</h1>
            <div id="results" class="results-container shadow-none border-none bg-transparent p-0 mt-0 text-center">
                Calculating results...
            </div>
            <p class="text-center text-gray-600 mt-4 text-sm">Thank you for completing the test. Your results have been
                recorded.</p>
            <div id="submissionStatus" class="text-center text-sm mt-2"></div>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw6BFW02H1NGBVQR0LqgFQCMZ8kzZ9zHnEpu98o0qYX2Jjerek4n6QiNB7twiPfSy5fdg/exec"; // !!! IMPORTANT: Replace !!!
        const QUIZ_DURATION_MINUTES = 30;

        // --- HAX Engineering Intern Assessment Test Data ---

        const questions = [
            // Section 1: Logical Reasoning
            {
                question: "1. Complete the sequence: 2, 5, 11, 23, __",
                options: [
                    "A) 45",
                    "B) 47", // Correct: Multiply by 2, add 1
                    "C) 46",
                    "D) 48"
                ],
                correctAnswer: 1, // Index of 'B) 47'
                image: null
            },
            {
                question: "2. Imagine a standard six-sided die. If the face '1' is opposite '6', '2' is opposite '5', what face is opposite '3'?",
                options: [
                    "A) 1",
                    "B) 2",
                    "C) 4", // Correct
                    "D) 5"
                ],
                correctAnswer: 2, // Index of 'C) 4'
                image: null
            },
            {
                question: "3. Gear is to Rotation as Piston is to _______.",
                options: [
                    "A) Cylinder",
                    "B) Engine",
                    "C) Reciprocation", // Correct
                    "D) Crankshaft"
                ],
                correctAnswer: 2, // Index of 'C) Reciprocation'
                image: null
            },
            {
                question: "4. All widgets are gizmos. Some gadgets are widgets. Which conclusion *must* be true?",
                options: [
                    "A) All gadgets are gizmos.",
                    "B) Some gadgets are gizmos.", // Correct
                    "C) No gizmos are gadgets.",
                    "D) All gizmos are widgets."
                ],
                correctAnswer: 1, // Index of 'B) Some gadgets are gizmos.'
                image: null
            },
            {
                question: "5. If the 2D net below is folded into a cube, which face will be opposite face 'C'?",
                options: [
                    "A) A",
                    "B) B",
                    "C) E", // Correct
                    "D) F"
                ],
                correctAnswer: 2, // Index of 'C) E'
                image: './img/quiz-img/me-question-05.png' // Note: The ASCII diagram is included in the question text.
            },
            {
                question: "6. What is the total capacitance when two capacitors, 10 μF and 20 μF, are connected in series?",
                options: [
                    "A) 30 μF",
                    "B) 6.67 μF", // Correct
                    "C) 15 μF",
                    "D) 2 pF"
                ],
                correctAnswer: 2, // Index of 'B) 6.67 μF'
                image: null
            },
            {
                question: "7. Statement 1: If the motor is running, the LED is on. Statement 2: The LED is off. What can you conclude?",
                options: [
                    "A) The motor is running.",
                    "B) The motor is not running.",
                    "C) The motor might be running.", // Correct
                    "D) The light switch is broken."
                ],
                correctAnswer: 2, // Index of 'C) The motor might be running.'
                image: null
            },
            {
                question: "8. If A > B, C < B, and D > A, which statement is definitely true?",
                options: [
                    "A) B > D",
                    "B) C > A",
                    "C) D > C", // Correct
                    "D) A = C"
                ],
                correctAnswer: 2, // Index of 'C) D > C'
                image: null
            },
            // Section 2: Critical Thinking & Problem Solving
            {
                question: "9. In a simple lever system (Class 1), if the effort arm is twice as long as the load arm, what is the ideal mechanical advantage?",
                options: [
                    "A) 0.5",
                    "B) 1",
                    "C) 2", // Correct
                    "D) 4"
                ],
                correctAnswer: 2, // Index of 'C) 2'
                image: null
            },
            {
                question: "10. Two wires, A and B, are made of the same material and have the same length. Wire A has twice the diameter of wire B. If the same tensile force is applied to both, how does the stress in A compare to the stress in B?",
                options: [
                    "A) Stress in A is twice the stress in B.",
                    "B) Stress in A is half the stress in B.",
                    "C) Stress in A is one-quarter the stress in B.", // Correct
                    "D) Stress in A is four times the stress in B."
                ],
                correctAnswer: 2, // Index of 'C) Stress in A is one-quarter the stress in B.'
                image: null
            },
            {
                question: "11. Four resistors are connected in a circuit as shown below. If they are placed in the circuit with a 60 volt power supply, determine the total circuit current.",
                options: [
                    "A) 2A",
                    "B) 0.5A",
                    "C) 4A", // Correct
                    "D) 0.4A"
                ],
                correctAnswer: 3, // Index of 'C) 4A'
                image: './img/quiz-img/ee-question-11.png'
            },
            {
                question: "12. According to Bernoulli's principle, in a steady flow of an incompressible, inviscid fluid, where the fluid velocity is highest, the pressure is:",
                options: [
                    "A) Highest",
                    "B) Lowest", // Correct
                    "C) Unchanged",
                    "D) Dependent only on density"
                ],
                correctAnswer: 1, // Index of 'B) Lowest'
                image: null
            },
            {
                question: "13. Calculate the equivalent resistance between points A and B in the circuit shown below.",
                options: [
                    "A) 1.25 Ω",
                    "B) 2.5 Ω", // Correct
                    "C) 1.5 Ω",
                    "D) 3.0 Ω"
                ],
                correctAnswer: 2, 
                image: './img/quiz-img/me-question-13.png'
            },
            {
                question: "14. A machine component is failing prematurely due to fatigue. Which factor is *least likely* to be a primary cause of fatigue failure?",
                options: [
                    "A) Cyclic loading",
                    "B) Stress concentrations (sharp corners)",
                    "C) Material defects",
                    "D) Static overload" // Correct
                ],
                correctAnswer: 3, // Index of 'D) Static overload'
                image: null
            },
            {
                question: "15. For a lightweight structure requiring high stiffness, which material property is most critical?",
                options: [
                    "A) Ultimate Tensile Strength",
                    "B) Specific Modulus (Young's Modulus / Density)", // Correct
                    "C) Ductility",
                    "D) Hardness"
                ],
                correctAnswer: 1, // Index of 'B) Specific Modulus (Young's Modulus / Density)'
                image: null
            },
            {
                question: "16. A DC motor fails to start. You measure voltage at the terminals and it's correct. What is the *next logical* step?",
                options: [
                    "A) Replace the power supply.",
                    "B) Measure the resistance of the power cord.",
                    "C) Check the motor brushes and commutator (if applicable) or motor windings for continuity.", // Correct
                    "D) Increase the supply voltage."
                ],
                correctAnswer: 2, // Index of 'C) Check the motor brushes...'
                image: null
            },
            {
                question: "17. A car accelerates uniformly from rest to 20 m/s in 5 seconds. What is its acceleration?",
                options: [
                    "A) 2 m/s²",
                    "B) 4 m/s²", // Correct
                    "C) 5 m/s²",
                    "D) 100 m/s²"
                ],
                correctAnswer: 1, // Index of 'B) 4 m/s²'
                image: null
            },
            {
                question: "18. Assume the Pulleys A, B, D are fixed in position and C is connected to a block that is placed on a frictionless surface and can move freely left and right. What would be the force needed to pull the weight W? Assume all pulleys are frictionless and massless.",
                options: [
                    "A) F = W",
                    "B) F = 2W",
                    "C) F = W/2", // Correct
                    "D) F = 4W"
                ],
                correctAnswer: 2, // Index of 'C) Rubber'
                image: "./img/quiz-img/me-question-18.png" //
            },
            {
                question: "19. A 10 kg block rests on a frictionless horizontal surface. A horizontal force of 50 N is applied. What is the acceleration of the block?",
                options: [
                    "A) 0.5 m/s²",
                    "B) 5 m/s²", // Correct
                    "C) 10 m/s²",
                    "D) 500 m/s²"
                ],
                correctAnswer: 1, // Index of 'B) 5 m/s²'
                image: null
            },
            {
                question: "20. A calculation assumes ideal gas behavior. Which condition makes this assumption *less* valid?",
                options: [
                    "A) Low pressure",
                    "B) High temperature",
                    "C) High pressure and low temperature", // Correct
                    "D) Low density"
                ],
                correctAnswer: 2, // Index of 'C) High pressure and low temperature'
                image: null
            },
            {
                question: "21. What is the primary function of feedback in a closed-loop control system?",
                options: [
                    "A) To increase the system's speed.",
                    "B) To reduce the difference between the desired output and the actual output.", // Correct
                    "C) To amplify the input signal.",
                    "D) To filter noise from the sensor."
                ],
                correctAnswer: 1, // Index of 'B) To reduce the difference...'
                image: null
            },
            {
                question: "22. A ball is dropped from a height 'h'. Neglecting air resistance, its potential energy at the top is equal to its _______ energy just before hitting the ground.",
                options: [
                    "A) Potential",
                    "B) Kinetic", // Correct
                    "C) Thermal",
                    "D) Total Mechanical"
                ],
                correctAnswer: 1, // Index of 'B) Kinetic'
                image: null
            },
            // Section 3: Quick Thinking & Application
            {
                question: "23. Estimate the approximate mass of a standard smartphone.",
                options: [
                    "A) 50 grams",
                    "B) 150-200 grams", // Correct
                    "C) 500 grams",
                    "D) 1 kilogram"
                ],
                correctAnswer: 1, // Index of 'B) 150-200 grams'
                image: null
            },
            {
                question: "24.  What is the standard frequency of AC supply voltage in India?",
                options: [
                    "A) 60 Hz",
                    "B) 120 Hz",
                    "C) 50 Hz", // Correct
                    "D) 55 Hz"
                ],
                correctAnswer: 3, // Index of 'C) 50 Hz'
                image: null
            },
            {
                question: "25. A graph shows velocity vs. time for an object. What does the area under the curve represent?",
                options: [
                    "A) Acceleration",
                    "B) Displacement", // Correct
                    "C) Jerk (rate of change of acceleration)",
                    "D) Average velocity"
                ],
                correctAnswer: 1, // Index of 'B) Displacement'
                image: null
            },
            {
                question: "26. Which thread type is commonly used for fasteners like bolts and screws in general mechanical applications in metric countries?",
                options: [
                    "A) Acme thread",
                    "B) Buttress thread",
                    "C) ISO Metric thread (e.g., M6, M8)", // Correct
                    "D) Whitworth thread"
                ],
                correctAnswer: 2, // Index of 'C) ISO Metric thread (e.g., M6, M8)'
                image: null
            },
            {
                question: "27. In engineering design, a safety factor is used to:",
                options: [
                    "A) Make the design cheaper.",
                    "B) Increase the operating speed.",
                    "C) Account for uncertainties in loads, material properties, and analysis.", // Correct
                    "D) Reduce the weight of the component."
                ],
                correctAnswer: 2, // Index of 'C) Account for uncertainties...'
                image: null
            },
            {
                question: "28. Which process is typically used to create complex plastic parts like casings for electronics in high volume?",
                options: [
                    "A) Sand casting",
                    "B) Forging",
                    "C) Injection molding", // Correct
                    "D) Machining from billet"
                ],
                correctAnswer: 2, // Index of 'C) Injection molding'
                image: null
            },
            {
                question: "29. If a pump moves water at 10 liters per minute, how long will it take to fill a 1 cubic meter tank? ",
                options: [
                    "A) 10 minutes",
                    "B) 100 minutes", // Correct
                    "C) 1000 minutes",
                    "D) 1 minute"
                ],
                correctAnswer: 1, // Index of 'B) 100 minutes'
                image: null
            },
            {
                question: "30. A dimension on a drawing is given as 25.0 ± 0.1 mm. What is the maximum permissible size?",
                options: [
                    "A) 24.9 mm",
                    "B) 25.0 mm",
                    "C) 25.1 mm", // Correct
                    "D) 0.1 mm"
                ],
                correctAnswer: 2, // Index of 'C) 25.1 mm'
                image: null
            },
            // Section 4: GD&T and Manufacturing
            {
                question: "31. What does the symbol '⌖' (position tolerance) control in a feature control frame?",
                options: [
                    "A) The flatness of a surface.",
                    "B) The location of a feature (like a hole) relative to datums.", // Correct
                    "C) The orientation (parallelism/perpendicularity) of a feature.",
                    "D) The circularity of a cylindrical feature."
                ],
                correctAnswer: 1, // Index of 'B) The location of a feature...'
                image: null
            },
            {
                question: "32. Why are datums (e.g., Datum A, B, C) established on an engineering drawing?",
                options: [
                    "A) To indicate the material specification.",
                    "B) To show hidden lines.",
                    "C) To provide a stable reference frame for dimensioning and tolerancing features.", // Correct
                    "D) To specify the surface finish required."
                ],
                correctAnswer: 2, // Index of 'C) To provide a stable reference frame...'
                image: null
            },
            {
                question: "33. What does the symbol 'Ⓜ' following a tolerance value in a feature control frame signify?",
                options: [
                    "A) The tolerance applies regardless of feature size.",
                    "B) The stated tolerance applies when the feature contains the maximum amount of material (e.g., smallest hole, largest pin), and bonus tolerance may be available as the feature departs from MMC.", // Correct
                    "C) The tolerance applies only when the feature contains the least amount of material (LMC).",
                    "D) The feature must be made from a specific material."
                ],
                correctAnswer: 1, // Index of 'B) The stated tolerance applies when...'
                image: null
            },
            {
                question: "34. You need to produce 10,000 identical, small, complex metal gears with high precision. Which manufacturing process is generally most suitable and cost-effective?",
                options: [
                    "A) Sand Casting",
                    "B) Manual Machining (Milling/Turning)",
                    "C) Metal Injection Molding (MIM) or Powder Metallurgy", // Correct
                    "D) Forging"
                ],
                correctAnswer: 2, // Index of 'C) Metal Injection Molding (MIM)...'
                image: null
            },
            {
                question: "35. What is the primary purpose of using cutting fluid during machining operations like drilling or milling?",
                options: [
                    "A) To increase the cutting speed only.",
                    "B) To make the workpiece heavier.",
                    "C) To cool the tool and workpiece, lubricate the cutting zone, and flush away chips.", // Correct
                    "D) To harden the surface of the workpiece."
                ],
                correctAnswer: 2, // Index of 'C) To cool the tool and workpiece...'
                image: null
            },
            {
                question: "36. A drawing specifies a surface finish requirement using a symbol like '√' with a number (e.g., 1.6). What does this number typically represent?",
                options: [
                    "A) The hardness of the surface in Rockwell C.",
                    "B) The thickness of the coating in millimeters.",
                    "C) The maximum allowable surface roughness average (Ra) in micrometers (μm).", // Correct
                    "D) The minimum depth of cut required."
                ],
                correctAnswer: 2, // Index of 'C) The maximum allowable surface roughness...'
                image: null
            },
            {
                question: "37. A shaft needs to fit smoothly into a bearing bore. Which GD&T control would be most critical to ensure proper alignment and rotation?",
                options: [
                    "A) Flatness of the shaft end face.",
                    "B) Circularity and Cylindricity of the shaft's outer diameter.", // Correct
                    "C) Position tolerance of a keyway on the shaft.",
                    "D) Profile of a surface on a non-critical feature."
                ],
                correctAnswer: 1, // Index of 'B) Circularity and Cylindricity...'
                image: null
            },
            {
                question: "38. For CNC machining, which factor typically has the *most significant* impact on the cost per part when producing a moderate volume (e.g., 500 units of spur gear)?",
                options: [
                    "A) Cost of the raw material block.",
                    "B) Machining time (related to complexity, material removal rate, setup time).", // Correct
                    "C) Cost of cutting tools.",
                    "D) Cost of electricity consumed."
                ],
                correctAnswer: 1, // Index of 'B) Machining time...'
                image: null
            },
            {
                question: "39. Why is performing a tolerance stack-up analysis important during the design phase?",
                options: [
                    "A) To determine the overall weight of the assembly.",
                    "B) To ensure that the accumulated variations from individual part tolerances will still allow the assembly to function correctly (e.g., parts fit together, required clearances are maintained).", // Correct
                    "C) To choose the color of the final product.",
                    "D) To calculate the shipping cost."
                ],
                correctAnswer: 1, // Index of 'B) To ensure that the accumulated variations...'
                image: null
            },
            {
                question: "40. Which inspection tool is most appropriate for accurately measuring the diameter of a precision ground pin with a tolerance of ±0.005 mm?",
                options: [
                    "A) Steel ruler",
                    "B) Vernier caliper",
                    "C) Micrometer", // Correct
                    "D) Tape measure"
                ],
                correctAnswer: 2, // Index of 'C) Micrometer'
                image: null
            }
        ];

        // Example: Accessing the first question
        // console.log(questions[0].question);
        // console.log(questions[0].options);
        // console.log(questions[0].correctAnswer); // Output: 1 (Index of the correct answer)




        // --- DOM Elements ---
        const userDetailsPage = document.getElementById('userDetailsPage');
        const quizPage = document.getElementById('quizPage');
        const resultsPage = document.getElementById('resultsPage');
        const userDetailsForm = document.getElementById('userDetailsForm');
        const quizForm = document.getElementById('quizForm');
        const questionsContainer = document.getElementById('questionsContainer');
        const resultsContainer = document.getElementById('results');
        const timerDisplay = document.getElementById('timer');
        const submitButton = document.getElementById('submitButton');
        const submissionStatus = document.getElementById('submissionStatus');
        const userNameInput = document.getElementById('userName');
        const userEmailInput = document.getElementById('userEmail');
        const userPhoneInput = document.getElementById('userPhone');
        const userNameError = document.getElementById('userNameError');
        const userEmailError = document.getElementById('userEmailError');
        const userPhoneError = document.getElementById('userPhoneError');
        const displayUserName = document.getElementById('displayUserName');
        const displayUserEmail = document.getElementById('displayUserEmail');
        const testDurationDisplay = document.getElementById('testDurationDisplay');
        const attemptedQuestions = document.getElementById('attemptedQuestions');



        // --- State ---
        let userAnswers = {};
        let userDetails = {};
        let timerInterval = null;
        let quizEndTime = null;
        let timeTaken = 0;
        let quizSubmitted = false;
        let attemptedQuestionsCount = 0;
        // --- Functions ---

        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(page => {
                page.classList.remove('active');
                page.classList.add('hidden');
            });
            const pageToShow = document.getElementById(pageId);
            if (pageToShow) {
                pageToShow.classList.remove('hidden');
                pageToShow.classList.add('active');
            } else {
                console.error("Page not found:", pageId);
            }
            window.scrollTo(0, 0);
        }

        function clearErrors() {
            userNameError.classList.add('hidden');
            userEmailError.classList.add('hidden');
            userPhoneError.classList.add('hidden');
            userNameInput.classList.remove('border-red-500');
            userEmailInput.classList.remove('border-red-500');
            userPhoneInput.classList.remove('border-red-500');
            submissionStatus.textContent = '';
        }

        function validateUserDetails() {
            clearErrors();
            let isValid = true;
            const name = userNameInput.value.trim();
            const email = userEmailInput.value.trim();
            const phone = userPhoneInput.value.trim();

            if (!name) {
                userNameError.textContent = 'Name is required.';
                userNameError.classList.remove('hidden');
                userNameInput.classList.add('border-red-500');
                isValid = false;
            }
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email) {
                userEmailError.textContent = 'Email is required.';
                userEmailError.classList.remove('hidden');
                userEmailInput.classList.add('border-red-500');
                isValid = false;
            } else if (!emailRegex.test(email)) {
                userEmailError.textContent = 'Please enter a valid email address.';
                userEmailError.classList.remove('hidden');
                userEmailInput.classList.add('border-red-500');
                isValid = false;
            }
            if (!phone) {
                userPhoneError.textContent = 'Phone number is required.';
                userPhoneError.classList.remove('hidden');
                userPhoneInput.classList.add('border-red-500');
                isValid = false;
            }
            return isValid;
        }

        function handleUserDetailsSubmit(event) {
            event.preventDefault();
            if (!validateUserDetails()) return;

            userDetails = {
                name: userNameInput.value.trim(),
                email: userEmailInput.value.trim(),
                phone: userPhoneInput.value.trim()
            };
            displayUserName.textContent = userDetails.name;
            displayUserEmail.textContent = userDetails.email;
            localStorage.setItem('quizUserDetails', JSON.stringify(userDetails));
            localStorage.setItem('quizUserAnswers', JSON.stringify({}));
            startQuiz();
        }

        function startQuiz() {
            renderQuestions();
            startTimer();
            // initializeQuizState();
            showPage('quizPage');
        }

        /**
         * Renders questions, options, and images (if available).
         */
        function renderQuestions() {
            questionsContainer.innerHTML = '';
            const savedAnswers = JSON.parse(localStorage.getItem('quizUserAnswers') || '{}');
            userAnswers = savedAnswers;

            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-container';
                questionDiv.id = `question-${index}`;

                // Add Question Text
                const questionText = document.createElement('div');
                questionText.className = 'question-text';
                // Use innerHTML in case question text contains simple formatting like <b>
                // Be cautious if questions come from untrusted sources.
                questionText.innerHTML = q.question;
                questionDiv.appendChild(questionText);

                // Add Image if available
                if (q.image && q.image.trim() !== "") { // Check if image URL is not null or empty
                    const imgElement = document.createElement('img');
                    imgElement.src = q.image;
                    imgElement.alt = `Image for question ${index + 1}`;
                    imgElement.className = 'question-image'; // Apply styling
                    // Add error handling for broken image links
                    imgElement.onerror = function () {
                        this.alt = `Image for question ${index + 1} failed to load.`;
                        this.style.display = 'none'; // Hide broken image icon
                        // Optionally display a placeholder or message
                        const errorMsg = document.createElement('p');
                        errorMsg.textContent = '[Image failed to load]';
                        errorMsg.className = 'text-red-500 text-sm my-4';
                        questionDiv.insertBefore(errorMsg, optionsDiv); // Insert before options
                    };
                    questionDiv.appendChild(imgElement);
                }


                // Add Options
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options-container';

                q.options.forEach((option, optionIndex) => {
                    const optionId = `q${index}_option${optionIndex}`;
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.name = `question${index}`;
                    radioInput.value = optionIndex;
                    radioInput.id = optionId;
                    radioInput.className = 'option-radio';
                    radioInput.addEventListener('change', () => handleAnswerSelection(index, optionIndex));

                    if (savedAnswers[index] === optionIndex) {
                        radioInput.checked = true;
                    }

                    const optionLabel = document.createElement('label');
                    optionLabel.htmlFor = optionId;
                    optionLabel.textContent = option;
                    optionLabel.className = 'option-label';
                    optionLabel.id = `label-${optionId}`;

                    optionsDiv.appendChild(radioInput);
                    optionsDiv.appendChild(optionLabel);
                });

                questionDiv.appendChild(optionsDiv);
                questionsContainer.appendChild(questionDiv);
            });
        }

        function handleAnswerSelection(questionIndex, optionIndex) {
            if (quizSubmitted) return;

            // Check if the question was previously unanswered
            if (!userAnswers.hasOwnProperty(questionIndex)) {
                attemptedQuestionsCount++; // Increment the count for a new attempt
            }

            // Update the user's answer
            userAnswers[questionIndex] = optionIndex;

            // Save the updated answers to localStorage
            localStorage.setItem('quizUserAnswers', JSON.stringify(userAnswers));

            // Update the attempted questions count in the UI
            updateAttemptedQuestionsCount();
        }

        function updateAttemptedQuestionsCount() {
            const attemptedQuestionsElement = document.getElementById('attemptedQuestions');
            attemptedQuestionsElement.textContent = attemptedQuestionsCount;
        }



        function handleAnswerSelection(questionIndex, optionIndex) {
            if (quizSubmitted) return;

            // Check if the question was previously unanswered
            if (!userAnswers.hasOwnProperty(questionIndex)) {
                attemptedQuestionsCount++; // Increment the count for a new attempt
            }

            // Update the user's answer
            userAnswers[questionIndex] = optionIndex;

            // Save the updated answers to localStorage
            localStorage.setItem('quizUserAnswers', JSON.stringify(userAnswers));

            // Update the attempted questions count in the UI
            updateAttemptedQuestionsCount();
        }

        function startTimer() {
            const savedEndTime = localStorage.getItem('quizEndTime');
            const now = Date.now();

            if (savedEndTime && parseInt(savedEndTime) > now) {
                quizEndTime = parseInt(savedEndTime);
            } else {
                quizEndTime = now + QUIZ_DURATION_MINUTES * 60 * 1000;
                localStorage.setItem('quizEndTime', quizEndTime);
            }

            updateTimerDisplay();
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                const remaining = quizEndTime - Date.now();
                if (remaining <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.textContent = "Time Expired!";
                    timerDisplay.classList.add('timer-expired');
                    forceSubmitQuiz();
                } else {
                    updateTimerDisplay();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const remaining = Math.max(0, quizEndTime - Date.now());
            const minutes = Math.floor((remaining / 1000 / 60) % 60);
            const seconds = Math.floor((remaining / 1000) % 60);
            timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            timerDisplay.classList.remove('timer-expired');
        }

        function calculateScore() {
            let score = 0;
            questions.forEach((q, index) => {
                if (userAnswers.hasOwnProperty(index) && userAnswers[index] === q.correctAnswer) {
                    score++;
                }
            });
            return score;
        }

        function generateDetailedResultsCSV() {
            const results = [];
            for (let i = 0; i < questions.length; i++) {
                if (!userAnswers.hasOwnProperty(i)) {
                    results.push("U"); // Unanswered
                } else if (userAnswers[i] === questions[i].correctAnswer) {
                    results.push("C"); // Correct
                } else {
                    results.push("I"); // Incorrect
                }
            }
            return results.join(',');
        }

        function calculateTimeTaken() {
            const endTime = Date.now();
            const startTime = quizEndTime - (QUIZ_DURATION_MINUTES * 60 * 1000);
            timeTaken = Math.round((endTime - startTime) / 1000);
            timeTaken = Math.min(timeTaken, QUIZ_DURATION_MINUTES * 60);
            timeTaken = Math.max(0, timeTaken);
        }

        function handleQuizSubmit(event) {
            if (event) event.preventDefault();
            if (quizSubmitted) return;
            forceSubmitQuiz();
        }

        function forceSubmitQuiz() {
            if (quizSubmitted) return;
            quizSubmitted = true;
            clearInterval(timerInterval);
            calculateTimeTaken();
            const score = calculateScore();
            const detailedResultsCSV = generateDetailedResultsCSV();

            submitButton.disabled = true;
            submitButton.textContent = 'Submitting...';
            document.querySelectorAll('.option-radio').forEach(radio => radio.disabled = true);

            const formData = {
                ...userDetails,
                timestamp: new Date().toISOString(),
                score: score,
                timeTaken: timeTaken,
                results: detailedResultsCSV
            };

            sendDataToGoogleSheet(formData);

            showPage('resultsPage');
            resultsContainer.textContent = `Calculating results...`;

            setTimeout(() => {
                resultsContainer.innerHTML = `Your Score: <strong class="text-xl">${score}</strong> / ${questions.length}`;
            }, 500);

            localStorage.removeItem('quizUserDetails');
            localStorage.removeItem('quizUserAnswers');
            localStorage.removeItem('quizEndTime');
        }

        function sendDataToGoogleSheet(data) {
            submissionStatus.textContent = '';
            if (!SCRIPT_URL || SCRIPT_URL === "YOUR_APPS_SCRIPT_WEB_APP_URL_HERE") {
                console.error("Google Apps Script URL is not configured!");
                submissionStatus.textContent = "Error: Could not submit results (URL missing).";
                submissionStatus.style.color = 'red';
                return;
            }
            const queryParams = new URLSearchParams(data);
            const urlWithParams = `${SCRIPT_URL}?${queryParams.toString()}`;
            console.log("Submitting to:", urlWithParams);

            fetch(urlWithParams, { method: "GET", mode: "no-cors" })
                .then(() => {
                    console.log("Data submission initiated (no-cors).");
                    submissionStatus.textContent = "Results submitted successfully.";
                    submissionStatus.style.color = 'green';
                })
                .catch(error => {
                    console.error("Error submitting data:", error);
                    submissionStatus.textContent = `Error: Could not submit results (${error.message}).`;
                    submissionStatus.style.color = 'red';
                });
        }
        function initializeQuizState() {
            const savedDetails = localStorage.getItem('quizUserDetails');
            const savedEndTime = localStorage.getItem('quizEndTime');
            const savedAnswers = JSON.parse(localStorage.getItem('quizUserAnswers') || '{}');
            const now = Date.now();
            testDurationDisplay.textContent = QUIZ_DURATION_MINUTES;

            // Calculate the initial number of attempted questions
            attemptedQuestionsCount = Object.keys(savedAnswers).length;
            updateAttemptedQuestionsCount(); // Update the UI with the initial count

            if (savedDetails && savedEndTime && parseInt(savedEndTime) > now) {
                userDetails = JSON.parse(savedDetails);
                console.log("Resuming quiz for:", userDetails.email);
                displayUserName.textContent = userDetails.name;
                displayUserEmail.textContent = userDetails.email;
                startQuiz();
            } else {
                showPage('userDetailsPage');
                localStorage.removeItem('quizUserDetails');
                localStorage.removeItem('quizUserAnswers');
                localStorage.removeItem('quizEndTime');
            }
        }

        // --- Event Listeners ---
        userDetailsForm.addEventListener('submit', handleUserDetailsSubmit);
        quizForm.addEventListener('submit', handleQuizSubmit);

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', initializeQuizState);

    </script>

</body>

</html>